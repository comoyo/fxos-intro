<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>TODO list</title>
    <style>
      html {
        min-height: 100%;
      }
      body {
        font: 20px Trebuchet MS;
        color: #00539F;
        text-shadow: #0095DD 0 1px;
        text-align: center;
        background: linear-gradient(to bottom, #EAEFF2, #D4DDE4);
      }
      #todoList li {
        list-style: none;
        margin: 10px;
      }
      #newTodo {
        width: 100%;
        height: 30px;
      }
    </style>
  </head>
  <body>
    <h1>My first TODO list</h1>
    <button id="install">Install app</button>
    <ul id="todoList">
      <li>Make TODO list</li>
      <li>Upload TODO list</li>
    </ul>
    <input id="newTodo" type="text" placeholder="Enter new things to do ..">
    <script>
      var inputBox = document.querySelector('#newTodo');
      var listContainer = document.querySelector('#todoList');
      var installButton = document.querySelector('#install');
      var manifestUrl = location.origin + '/manifest.webapp';

      function remove(element) {
        element.parentElement.removeChild(element)
      }

      if (navigator.mozApps) {
        var checkRequest = navigator.mozApps.checkInstalled(manifestUrl);
        checkRequest.onsuccess = function() {
          if (checkRequest.result)
            remove(installButton);
        };
      } else {
        remove(installButton);
      }

      inputBox.addEventListener('keypress', function addTodo(event) {
        if (event.keyCode === 13) {
          var listElement = document.createElement('li');
          listElement.textContent = inputBox.value;
          listContainer.appendChild(listElement);
          inputBox.value = '';
        }
      }, false);

      listContainer.addEventListener('click', function markTodo(event) {
        var listElement = event.target;
        listContainer.removeChild(listElement);
      }, false);

      installButton.addEventListener('click', function() {
        var installRequest = navigator.mozApps.install(manifestUrl);
      }, false);
    </script>
  </body>
</html>
